
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>DASHBOARD</title>
	<meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Bootstrap Lesson</title>

    <!-- Bootstrap -->
    <link href="/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/css/style.css">
  <!--   <link rel="stylesheet" href="assets/css/font-awesome.min.css"> -->
     <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>
<body data-spy="scroll" data-offset="100">

	             <style>
                    .custom{
                        background-color:#158882;
                        color: white;
                    }
                </style>
                <div class="custom col-md-12 col-sm-12">
                <div class="col-md-6 col-sm-6">
                <form action="">
                    <table>
                         <tr>
                            <th><h3>  &nbsp;&nbsp;&nbsp;&nbsp;Wine Cosmetic Shop&nbsp;&nbsp;&nbsp;&nbsp;  </h3></th>
                            <th><h5> <br><br>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Point Of Sale System&nbsp;&nbsp;  </h5></th>
                        </tr>
                        <tr>
                            <td>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Mya yamon kantharya realty,ThinGanGyun&nbsp;&nbsp;<br>  <br></td>
                            <td>  &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ph no::09250307723
                                <br><br></td>

                        </tr>

                    </table>
                </form>
                </div>
                <div class="col-md-6 col-sm-6">
                    <style>
                     .glyphicon{
                        font-size: 15px;

                     }
                     .btn{
                        box-sizing: border-box;
                        box-shadow: 5px 5px 3px #306;
                        border: 0.5px solid #351A8E;
                        margin-right: 40px;
                       background-image: linear-gradient(to bottom right,#092C79,#1bcedf) ;
                     }

                    </style>


                    <!-- <script type="text/javascript">
                        $(document).ready(function(){
                            $('img').click(function(){
                                $('a').slideDown(1000);
                            })
                        })
                    </script> -->
                    <div class="nav navbar-nav navbar-right" style="padding-top:5%">
                        <button type="button" class="btn btn-info btn-md pull-right" data-toggle="modal" data-target="#exampleModal" id="watch"> <span class="glyphicon glyphicon-calendar" style="color: white;">&nbsp;Calendar</span>
                        </button>
                    </div>

                </div>


                </div>
            </nav>
            </div>
<!-- -----------------------------------pager------------------------- -->
            <div class="row">
                <div class="col-md-12">
                    <ol class="pager">
                        <li class="previous">
                          <span class="glyphicon glyphicon-list"style="padding-bottom: 10px;font-size: 20px;">/Sale</span></li>
                        <li class="next" style="margin-right: 20px; ">
                          <a href="/">
                              <span class="glyphicon glyphicon-log-out"  style="color: black;">&nbsp;Logout
                              </span>
                            </a>
                        </li>
                    </ol>
                </div>
            </div>
    <!-- -----------------------------------form------------------------------------- -->
    <div class="row">
      <div class="col-md-4">
         <div class="well" style="overflow: auto;">
            <form action="#" class="form-horizontal" method="post">
							<input type="hidden" id="proid" name="proid" value="">
              <center><table>
              	<tr>
                  <td style="padding: 3px;"><label for="barcode" class="col-md-6" style="width:50%; text-align: right;">Barcode:</label></td>
                  <td><input type="text" class="col-md-6" id="barcode" style="width: 100%" name="barcode"></td>
                </tr>
                <tr>
                  <td style="padding: 3px;"><label for="itemname" class="col-md-6" style="width:50%; text-align: right;">Item_Name:</label></td>
                  <td><input type="text" class="col-md-6" id="itemname" style="width: 100%;" name="itemname"></td>
                </tr>
                <tr>
                  <td style="padding: 3px;"><label for="itemtype" class="col-md-6" style="width:50%; text-align: right;">Item_Type:</label></td>
                  <td><input type="text" class="col-md-6" id="itemtype" style="width: 100%;" name="itemtype"></td>
                </tr>
                <tr>
                <tr>
                  <td style="padding: 3px;"><label for="brandname" class="col-md-6" style="width:50%; text-align: right;">Brand_Name:</label></td>
                  <td><input type="text" class="col-md-6" id="brandname" style="width: 100%;" name="brandname"></td>
                </tr>

                <tr>
                  <td style="padding: 3px;"><label for="Saleprice" class="col-md-6" style="width:50%; text-align: right;">Sale_Price:</label></td>
                  <td><input type="text" class="col-md-6" id="saleprice" style="width: 100%;" name="saleprice"></td>
                </tr>
                <tr>
                  <td style="padding: 3px;"><label for="qty" class="col-md-6" style="width:50%; text-align: right;">Qty:</label></td>
                  <td><input type="number" min="1" value="1" class="col-md-6" id="qty" style="width: 100%;" name="qty" onchange="fun(this.value)"></td>
                </tr>
                <tr>
                  <td style="padding: 3px;"><label for="remark" class="col-md-6" style="width:50%; text-align: right;">Amount:</label></td>
                  <td><input type="text" class="col-md-6" id="amount" style="width: 100%;" name="amount"></td>
                </tr>
                </table>
							</center><br>

                 <style type="text/css">
                                .button{
                                    background-color: #1A8E0A;
                                    width: 80px;
                                    height: 32px;
                                    text-align: center;
                                    text-decoration: none;
                                    color: white;
                                    border-radius: 0px;
                                    font-size: 16px;
                                }

                            </style>
														<center>
															<div class="col-md-12">
                                <input type="button" style="width: 80px;color:white;" id="totalprofit" name="" value="insert" class="btn" onclick="additem(this.form);">&nbsp;
                            	</div>
														</center>


            </form>
          </div>
      </div>


						<div class="col-md-8 ">
							<div class="well" style="overflow:auto; max-height: 400px; " >
									 <div class="row" >
										 <!-- <h4>Sale table</h4><hr style="color:black;border:0.5px solid #666;"> -->
										 <div class="col-lg-3 col-md-4 col-sm-5 col-xs-5">
										 		<label>Brand_Name</label>
										 		<select class="" name="bname" style="width:30%;height:auto;" id="bname">
													<% for(var i =0; i< brand.length; i++){%>
										 				<option value="<%= brand[i]._id %>"><%= brand[i].name %></option>
												 <%}%>
										 		</select>
											</div>
											<div class="col-lg-3 col-md-4 col-sm-5 col-xs-5"
												<label><b>Item_Type</b></label>
												<select class="" name="ctype" style="width:30%;height:auto;" id="ctype">
													<% for(var j =0; j< category.length; j++){%>
										 				<option value="<%= category[j].name %>"><%= category[j].name %></option>
												 <%}%>
												</select>
											</div>
											<div class="col-lg-3 col-md-4 col-sm-2 col-xs-2">
												<input type="submit" name="" value="search" class="btn" style="color:white;" onclick="myFunction()">
											</div>
										</div>
								 </div>
								 <div class="well" style="overflow: auto;" id="tab">
                   <form action="" class="form-horizontal">
 										<table class="table table-striped"  id="tabf">
                        <thead>
														<th>Item Name</th>
                            <th>Barcode</th>
                            <th>Sale Price</th>
                            <th>Qty</th>
                        </thead>
												<tbody>
												</tbody>
											</table>
										</form>
									</div>
							 </div>
            </div>
            <div class="row">
                <div class="col-md-12">
									<fieldset>
											<legend></legend>
									</fieldset>
                    <div class="col-md-8">


                            <style type="text/css">
                                        .btnInventory{
                                            color: #000;
                                            display: inline-block;
                                            width: 70px;
                                            height: 50px;
                                            border: 1px solid #ccc;
                                            background-color: #F2F2F2;
                                            box-shadow: 0px 0px 3px #000;
                                        }
                                        .btnInventory .glyphicon{
                                           /*  margin-top: 30px;
                                           font-size: 40px; */
                                        }
                                        .btnInventory h5{
                                            font-size: 15px;
                                        }
                                        .btnInventory:hover{
                                            color: #fa0;
                                            text-decoration: none;
                                            box-shadow: 2px 2px 4px #000;
                                        }
                                    </style>
                                    <br>
                <div class="well" style="overflow: auto;">
                  <form action="" class="form-horizontal">
										<table class="table table-striped" id="tabre">
											<h4><b><i>Sale Table</i></b></h4>
											<thead>
												<th>Barcode</th>
												<th>Item Name</th>
												<th>Sale Price</th>
												<th>Qty</th>
												<th>Amount</th>
												<th>Remove</th>
											</thead>
                       <tbody>

                       </tbody>

                      </table>
                       <style type="text/css">
                                .button{
                                    background-color: #1A8E0A;
                                    width: 80px;
                                    height: 32px;
                                    text-align: center;
                                    text-decoration: none;
                                    color: white;
                                    border-radius: 0px;
                                    font-size: 16px;
                                }

                            </style>


                            <div class="col-md-12" style="text-align: right;">
                                <label for="totalprofit" style="width: 150px;text-align: right; color: black;"><button>Total</button></label>
                                <input type="text" style="width: 80px;" id="totalprofit"  onclick="sum()"  name="total" value="0">&nbsp;
                            </div>


                   <style type="text/css">
                                .button{
                                    background-color: #245718;
                                    width: 70px;
                                    height: 30px;
                                    text-align: center;
                                    text-decoration: none;
                                    color: white;
                                    border-radius: 5px;
                                }
                                 .Cancel{
                                    background-color: #C21D0E;
                                    width: 70px;
                                    height: 30px;
                                    text-align: center;
                                    text-decoration: none;
                                    color: white;
                                    border-radius: 5px;
                                }
                            </style>
                <div class="col-md-7" style="text-align: right;">
                    <a id="printing"><input type="button" value="Print" class="button"></a>&nbsp;
                    <a href="#"><input type="button" value="Check Out" onclick="checkfun();" class="btn btn-primary"></a>
                </div><br><br>
               </form>
               </div>
            </div><br>


        </div>
      </div>


    <script rel="stylesheet" src="/js/jquery.min.js"></script>
    <script rel="stylesheet" src="/js/bootstrap.min.js"></script>
		<script>
        $('#myModal').on('shown.bs.modal', function () {
        $('#myInput').trigger('focus')
            })
    </script>
		<script type="text/javascript">

			$('#barcode').blur(function(){
				var dataB = {barcode:$('#barcode').val()};
				$.ajax({url:'/sales/checkbar',data:dataB,type:'POST',
					success:function (result) {
						if (result.data != null) {
							$('#itemname').val(result.data.itemName);
							$('#itemtype').val(result.data.itemType);
							$('#brandname').val(result.data.brand_id.name);
							$('#saleprice').val(result.data.salePrice);
							$('#amount').val(result.data.salePrice);
							$('#qty').val(1);
							$('#proid').val(result.data._id)
						}

					}
			})
			})
			var product =[];
			var tol = 0;
			function additem(f) {
				var data = {};
				Object.assign(data,{product_id:$('#proid').val()},{count:f.qty.value});
				var index = product.findIndex(x => x.product_id === $('#proid').val());
				if (index <= -1) {
						product.push(data)
						tol += (Number(f.qty.value)* Number(f.saleprice.value));
						var markup = "<tr class='"+f.barcode.value+"'><td>" + f.barcode.value +"</td><td>" + f.itemname.value + "</td><td>" + f.saleprice.value +"</td><td>"+f.qty.value+"</td><td>"+Number(f.qty.value)* Number(f.saleprice.value)+"</td><td><button onclick='removeI("+f.barcode.value+");'>clear</button></td></tr>";
						$("#tabre tbody").append(markup);
					}
					$('#itemname').val('');
					$('#itemtype').val('');
					$('#brandname').val('');
					$('#saleprice').val('');
					$('#amount').val('');
					$('#barcode').val('');
					$('#proid').val('')
			}

			function checkfun() {
				const Url = "/sales/checkout";
				var data = {
					product : product,
					tol : tol,
				}
					$.ajax({
						url:Url,
						type :'POST',
						data :JSON.stringify(data),
		  				contentType: "application/json; charset=utf-8",
		  				dataType: "json",
						success: function(result) {
							if(result.status){
								$('#printing').attr('href','/sales/salevoucher/'+result.id);
								alert('checkout complete!!');
							}
						}
					})
			}

			function removeI(barc) {
				console.log($("#tabre").find("tr."+barc));
				$("#tabre").find("tr."+barc).remove();
			}
		</script>
		<script type="text/javascript">
			function fun(qty) {
					$('#amount').val(Number($('#qty').val())*Number($('#saleprice').val()))

			}
		</script>


		<script type="text/javascript">
		function showtime(){
				var d = new Date(),
					 minutes = d.getMinutes().toString().length == 1 ? '0'+d.getMinutes() : d.getMinutes(),
					 hours = d.getHours().toString().length == 1 ? '0'+d.getHours() : d.getHours(),
					 ampm,
					 months = ['Jan','Feb','March','April','May','Jun','July','Aug','Sep','Oct','Nov','Dec'],
					 days = ['Sunday','Monday','Tuesday','Wednesday','Thursday','Friday','Saturaday'];
					 if (hours>=12) {
						 hours=hours-12;
						 ampm='PM';
					 }else {

						 ampm='AM';
					 }
				 var show =hours+':'+minutes+' '+ampm+'<br>'+days[d.getDay()]+','+d.getDate()+' '+
				 months[d.getMonth()]+' '+d.getFullYear();
				 document.getElementById('watch').innerHTML=show;
				 }
				 showtime();
				 setInterval(showtime,1000);
		</script>
		<script type="text/javascript">
			$('#tab').hide();
			function myFunction(clickid) {
				$('#tab').show();
				$("#tabf tbody").empty();
				var datap={brand:$('#bname').val(),type:$('#ctype').val()};
				$.ajax({
					url:'/sales/finditem',
					type:'POST',
					data:datap,
					success:function (result) {
						if (result.data) {
							for(var i = 0; i < result.data.length; i++){
								var markup = "<tr><td>" + result.data[i].itemName +"</td><td>" + result.data[i].barCode + "</td><td>" + result.data[i].salePrice +"</td><td>"+result.data[i].Qty+"</td></tr>";
								$("#tabf tbody").append(markup);
							}

						}

					}
				})
			}
		</script>
		<!-- <script type="text/javascript">
		document.querySelector('.btn').addEventListener('click',function(){
			document.querySelector('.toggle').classList.toggle('hidden');
		});
		</script> -->
</body>
</html>
